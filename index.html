<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DF Plus Accessories</title>

<style>
body{font-family:Arial;margin:0;background:#f8fafc}
header{background:#0f172a;color:#fff;padding:1rem;text-align:center}

.controls{display:flex;gap:8px;padding:10px;background:#fff;position:sticky;top:0;z-index:10}
.controls input,.controls select{
 padding:10px;flex:1;border-radius:8px;border:1px solid #cbd5e1
}

.catalog{
 padding:1rem;
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
 gap:1rem
}

.product{
 background:#fff;border-radius:12px;padding:10px;
 box-shadow:0 6px 16px rgba(0,0,0,.08)
}
.product img{
 width:100%;height:160px;object-fit:cover;border-radius:10px
}
.btn{
 background:#25d366;color:#fff;padding:12px;
 border:none;border-radius:8px;font-weight:bold;cursor:pointer
}

/* CART */
.cart-btn{
 position:fixed;bottom:20px;right:20px;
 background:#0f172a;color:#fff;
 padding:14px 18px;border-radius:40px;border:none;z-index:100
}

#cart{
 position:fixed;right:-420px;top:0;height:100%;
 width:360px;background:#fff;
 box-shadow:-8px 0 30px rgba(0,0,0,.25);
 transition:.3s;z-index:200
}
#cart.open{right:0}
#cartBox{padding:1rem;height:100%;overflow-y:auto}
@media(max-width:600px){
 #cart{width:100%}
}
</style>
</head>

<body>

<header>
<h2>DF Plus Accessories</h2>
<p>Computer & Phone Accessories</p>
</header>

<div class="controls">
<input id="search" placeholder="Search..." onkeyup="filterProducts()">
<select id="category" onchange="filterProducts()">
<option value="all">All</option>
<option value="computer">Computer</option>
<option value="phone">Phone</option>
</select>
</div>

<section id="catalog" class="catalog"></section>

<button class="cart-btn" onclick="openCart()">ðŸ›’ Cart (<span id="cartCount">0</span>)</button>

<!-- CART -->
<div id="cart">
<div id="cartBox">
<h3>Your Cart</h3>
<div id="cartItems"></div>
<p id="cartTotal"></p>

<h4>Delivery Details</h4>
<input id="custName" placeholder="Full Name" style="width:100%;padding:10px;margin:6px 0">
<input id="custPhone" placeholder="Phone Number" style="width:100%;padding:10px;margin:6px 0">
<input id="custAddress" placeholder="Address" style="width:100%;padding:10px;margin:6px 0">
<input id="custCity" placeholder="City / Area" style="width:100%;padding:10px;margin:6px 0">

<button class="btn" onclick="checkout()">Checkout on WhatsApp</button>
<button onclick="closeCart()" style="width:100%;margin-top:8px">Continue Shopping</button>
</div>
</div>

<script>
/* ===== CONFIG ===== */
const WHATSAPP = "2347060402854"; // your number
const DELIVERY = 2500;

/* ===== DATA ===== */
let products = [];
let cart = [];

/* ===== LOAD PRODUCTS FROM CSV ===== */
fetch('products.csv')
.then(r=>r.text())
.then(data=>{
 const rows = data.trim().split("\n").slice(1);
 products = rows.map(r=>{
   const [id,name,category,brand,price,discount,image]=r.split(",");
   return {id,name,category,brand,price:+price,discount:+discount,image};
 });
 render(products);
});

/* ===== RENDER ===== */
function render(list){
 catalog.innerHTML="";
 if(!list.length){catalog.innerHTML="<p>No products yet</p>";return;}
 list.forEach((p,i)=>{
  const price = p.discount || p.price;
  catalog.innerHTML+=`
  <div class="product">
   <img src="${p.image}">
   <h3>${p.name}</h3>
   <small>${p.brand} â€¢ ${p.category}</small>
   <p><b>â‚¦${price}</b></p>
   <button class="btn" onclick="add(${i})">Add to Cart</button>
  </div>`;
 });
}

/* ===== FILTER ===== */
function filterProducts(){
 const s = search.value.toLowerCase();
 const c = category.value;
 render(products.filter(p=>p.name.toLowerCase().includes(s)&&(c==="all"||p.category===c)));
}

/* ===== CART ===== */
function add(i){
 const p = products[i];
 const f = cart.find(x=>x.name===p.name);
 if(f) f.qty++; else cart.push({name:p.name,price:(p.discount||p.price),qty:1});
 cartCount.innerText = cart.length;
}

function openCart(){
 cart.classList.add("open");
 let html="", total=0;
 cart.forEach((i,n)=>{
  total+=i.qty*i.price;
  html+=`<div style="border-bottom:1px solid #e5e7eb;padding:8px 0">
   <b>${i.name}</b><br>
   Qty: ${i.qty}
   <span style="float:right">â‚¦${i.qty*i.price}</span>
  </div>`;
 });
 cartItems.innerHTML = html || "<p>Cart empty</p>";
 cartTotal.innerHTML = cart.length
  ? `Subtotal â‚¦${total}<br>Delivery â‚¦${DELIVERY}<br><b>Total â‚¦${total+DELIVERY}</b>`
  : "";
}

function closeCart(){ cart.classList.remove("open"); }

/* ===== WHATSAPP CHECKOUT ===== */
function checkout(){
 if(!cart.length) return alert("Cart empty");
 if(!custName.value||!custPhone.value||!custAddress.value||!custCity.value)
  return alert("Fill delivery details");

 let msg=`ðŸ§¾ *New Order*%0A`;
 msg+=`Name: ${custName.value}%0A`;
 msg+=`Phone: ${custPhone.value}%0A`;
 msg+=`Address: ${custAddress.value}, ${custCity.value}%0A%0A`;

 let sub=0;
 cart.forEach((i,n)=>{
  sub+=i.qty*i.price;
  msg+=`${n+1}. ${i.name} x${i.qty} â‚¦${i.qty*i.price}%0A`;
 });

 msg+=`%0ASubtotal â‚¦${sub}%0ADelivery â‚¦${DELIVERY}%0A*TOTAL â‚¦${sub+DELIVERY}*`;

 window.open(`https://wa.me/${WHATSAPP}?text=${msg}`,"_blank");

 cart=[];cartCount.innerText=0;closeCart();
}
</script>

</body>
</html>
